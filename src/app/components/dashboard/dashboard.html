<div class="layout">
  <!-- Sidebar -->
  <div class="sidebar" [class.collapsed]="isCollapsed">
    <div class="sidebar-header">
      <span *ngIf="!isCollapsed">ğŸ§­ Survey Admin</span>
      <span *ngIf="isCollapsed">ğŸ§­</span>
    </div>

    <ul>
      <li class="active"><span>ğŸ“Š</span><span *ngIf="!isCollapsed">Dashboard</span></li>
      <li><span>ğŸ“</span><span *ngIf="!isCollapsed">Create Survey</span></li>
      <li><span>â°</span><span *ngIf="!isCollapsed">Reminders</span></li>
      <li><span>ğŸ‘¥</span><span *ngIf="!isCollapsed">Employees</span></li>
    </ul>

    <div class="sidebar-footer" (click)="logout()">
      ğŸšª <span *ngIf="!isCollapsed">Logout</span>
    </div>
  </div>

  <!-- Main -->
  <div class="main">
    <!-- Header -->
    <div class="header">
      <div class="left">
        <button class="toggle-btn" (click)="toggleSidebar()">â˜°</button>
        <input type="text" class="search-input" placeholder="Search surveys..." />
      </div>

      <div class="profile" (click)="dropdownOpen = !dropdownOpen">
        <img [src]="profileImage" alt="avatar" class="avatar" />
        <div *ngIf="!isCollapsed">
          <div class="name">{{ adminName }}</div>
          <div class="role">{{ adminRole }}</div>
        </div>
        <span class="arrow">â–¼</span>
        <div class="dropdown" *ngIf="dropdownOpen">
          <a href="#">Profile</a>
          <a href="#" (click)="logout()">Logout</a>
        </div>
      </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard-body">
      <h1>Dashboard</h1>
      <p class="subtitle">Overview of survey analytics and performance</p>

      <!-- Summary Cards -->
      <div class="cards">
        <div class="card">
          <div class="title">Total Surveys Created</div>
          <div class="value">{{ animatedTotalSurveys | number }}</div>
        </div>
        <div class="card">
          <div class="title">Total Responses</div>
          <div class="value">{{ animatedTotalResponses | number }}</div>
        </div>
        <div class="card">
          <div class="title">Pending Responses</div>
          <div class="value">{{ animatedPendingResponses | number }}</div>
        </div>
      </div>

      <!-- Filter Tabs -->
      <div class="filter-tabs">
        <button [class.active]="activeFilter === 'department'" (click)="activeFilter = 'department'">Department</button>
        <button [class.active]="activeFilter === 'survey'" (click)="activeFilter = 'survey'">Survey</button>
      </div>

      <!-- Filters -->
      <div class="filters" *ngIf="activeFilter === 'department'">
        <label>Department:</label>
        <select [(ngModel)]="selectedDept">
          <option>All Departments</option>
          <option *ngFor="let d of departments">{{ d.department }}</option>
        </select>
        <label>From:</label><input type="date" [(ngModel)]="fromDate" />
        <label>To:</label><input type="date" [(ngModel)]="toDate" />
        <button class="apply" (click)="applyFilters()">Apply Filter</button>
        <button class="clear" (click)="clearFilters()">Clear</button>
      </div>

      <div class="filters" *ngIf="activeFilter === 'survey'">
        <label>Survey:</label>
        <select [(ngModel)]="selectedSurvey">
          <option>All Surveys</option>
          <option *ngFor="let s of surveys">{{ s.title }}</option>
        </select>
        <label>From:</label><input type="date" [(ngModel)]="fromDate" />
        <label>To:</label><input type="date" [(ngModel)]="toDate" />
        <button class="apply" (click)="applyFilters()">Apply Filter</button>
        <button class="clear" (click)="clearFilters()">Clear</button>
      </div>

      <!-- Charts -->
      <div class="charts" *ngIf="filterApplied">
        <div class="chart">
          <h3>ğŸ“Š Response Rate by {{ activeFilter | titlecase }}</h3>
          <canvas baseChart [data]="barChartData" [options]="barChartOptions" chartType="bar"></canvas>
        </div>
        <div class="chart">
          <h3>ğŸ“ˆ Response Breakdown</h3>
          <canvas baseChart [data]="pieChartData" [options]="pieChartOptions" chartType="doughnut"></canvas>
        </div>
      </div>

      <!-- Employees -->
      <div class="employee-lists" *ngIf="filterApplied && activeFilter === 'department'">
        <div class="employee-box submitted">
          <h3>âœ… Submitted ({{ submittedEmployees.length }})</h3>
          <div *ngFor="let e of submittedEmployees" class="employee-item">{{ e.name }}</div>
        </div>
        <div class="employee-box pending">
          <h3>âš ï¸ Pending ({{ pendingEmployees.length }})</h3>
          <div *ngFor="let e of pendingEmployees" class="employee-item">{{ e.name }}</div>
        </div>
      </div>

      <!-- Recent Surveys -->
      <div class="survey-table">
        <h3>Recent Surveys</h3>
        <table>
          <thead>
            <tr>
              <th>Survey Title</th>
              <th>Department</th>
              <th>Published Date</th>
              <th>Completion</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let s of surveys">
              <td>{{ s.title }}</td>
              <td>{{ s.department }}</td>
              <td>{{ s.publishedDate | date }}</td>
              <td>
                <div class="progress"><div class="bar" [style.width]="s.responseRate + '%'"></div></div>
                <span>{{ s.responseRate }}%</span>
              </td>
              <td><span class="badge">{{ s.status }}</span></td>
              <td>ğŸ‘ ğŸ—‘</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Export -->
      <div class="export-row">
        <div>ğŸ“ Export Report â€” Download in your preferred format</div>
        <div>
          <button class="btn-outline" (click)="exportPDF()">Export PDF</button>
          <button class="btn-primary" (click)="exportPPT()">Export PPT</button>
        </div>
      </div>
    </div>
  </div>
</div>
